<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<title>Edit Expense</title>
		<link rel="icon" th:href="@{/dist/images/Dextero_Icon.ico}" type="image/x-icon" />
        <link th:href="@{https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700}" rel="stylesheet" />
        <link rel="stylesheet" th:href="@{/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css}"/>
        <link rel="stylesheet" th:href="@{/plugins/datatables-responsive/css/responsive.bootstrap4.min.css}" />
        <link rel="stylesheet" th:href="@{/dist/css/dextero.css}">
        <link rel="stylesheet" th:href="@{/dist/css/all.css}">

        <script th:src="@{/plugins/jquery/jquery.min.js}"></script>
        <script th:src="@{/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
        <script th:src="@{/plugins/datatables/jquery.dataTables.min.js}"></script>
        <script th:src="@{/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js}"></script>
        <script th:src="@{/plugins/datatables-responsive/js/dataTables.responsive.min.js}"></script>
        <script th:src="@{/plugins/datatables-responsive/js/responsive.bootstrap4.min.js}"></script>
        <script th:src="@{/dist/js/dextero.js}"></script>
        <script th:src="@{/dist/js/all.js}"></script>

   		<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
  		<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
		<link rel="stylesheet" href="https://cdn.datatables.net/select/1.3.4/css/select.dataTables.min.css">
		<script src="https://cdn.datatables.net/select/1.3.4/js/dataTables.select.min.js"></script>
</head>

	<body class="hold-transition sidebar-mini layout-fixed">
    	<header th:include="header::header1"></header> 
		<div class="content-wrapper">
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-header text-center pb-2 d-bg-h2 ">
                                <lable id="label" class="h2 font-weight-bold">Edit Expense</lable>    
                            </div>
                            <div class="card card-box-new tech-x-card-2 mt-5">
                                <div class="card-body">
                                    <form action="#" th:action="@{/SaveEdit1Expense}" th:object="${expense}" method="POST"
                                    enctype="multipart/form-data" autocomplete="off">
                                    
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <input type="hidden" th:field="*{id}">
										
                                       <div class="row mt-4">
                                            <div class="col-sm-5 required-field">
                                                <label class="d-label" for="date">Expense Category:</label>
                                            </div>
                                            <div class="col-sm-4">
                                                <select  class="input-anime form-control" th:field="*{Category}" id="Category" required>
                                                    <option value="Travel">Travel</option>
                                                    <option value="Stay">Stay</option>
                                                    <option value="Telephone">Telephone</option>
                                                    <option value="Food">Food</option>
                                                </select>
                                            </div>
                                        </div>
										<div class="content">
       										<div id="Travel" class="data">
       											<div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">From Location:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <input type="text" class="form-control input-anime"  th:field="*{FromLocation}" id="fromlocation" value="--"
                                                        placeholder="Location" required>
                                                    </div>  
                                                </div> 
                                                
                                                <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">To Location:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <input type="text" class="form-control input-anime"  th:field="*{ToLocation}" id="tolocation" value="--"
                                                         placeholder="Location" required>
                                                    </div>  
                                                </div> 

                                                <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">Mode of Travel:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <select class="form-control input-anime"  id="mode" th:field="*{ModeOfTravel}" required>
                                                            <option th:value="*{ModeOfTravel}" th:text="*{ModeOfTravel}" selected>
                                                            <option value="--"></option>
                                                            <option value="Car">Car</option>
                                                            <option value="Train">Train</option>
                                                            <option value="Flight">Flight</option>
                                                            <option value="Auto">Auto</option>
                                                        </select>
                                                    </div>  
                                                </div> 
       											</div>
       										</div>
                                        <div id="Stay" class="data">
                                            <div class="row mt-4">
                                                 <div class="col-sm-5 required-field">
                                                    <label class="d-label">Location:</label>
                                                 </div>
                                                 <div class="col-sm-4">
                                                     <input type="text"  class="form-control input-anime"  th:field="*{Location}" id="location" 
                                                      value="--" placeholder="Location" required>
                                                 </div>  
                                            </div> 
                                        </div>
                                            <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">From Date:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                    <input type="text"  class="form-control input-anime" th:field="*{FromDate}" 
                                                    id="fromdate" placeholder="DD-MM-YYYY" required>
                                                    </div>  
                                                </div> 

                                                <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">To Date:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                    <input type="text"  class="form-control input-anime" th:field="*{ToDate}" id="todate" 
                                                    placeholder="DD-MM-YYYY" required>
                                                    </div>  
                                                </div> 
                                                
                                                <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">Vendor Name:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                    <input class="form-control input-anime" type="text" th:field="*{Vendor}" 
                                                    placeholder="Enter Vendor Name" required>
                                                    </div>  
                                                </div> 

                                                <div class="row mt-4">
                                                    <div class="col-sm-5 required-field">
                                                        <label class="d-label">Amount:</label>
                                                    </div>
                                                    <div class="col-sm-2">
                                                    	<select class="form-control input-anime"  th:field="*{currency}" id="mySelect" required>
                                                    		<!-- <option th:value="*{currency}" th:text="*{currency}" selected> -->
			                                                <option th:each="expense:${currencyList}" 
			                                                		th:value="${expense.addcurrency}"
			                                                    	th:text="${expense.addcurrency}" >
			                                                </option>
                                                    	</select>
                                                    </div>
                                                    <div class="col-sm-4">
                                                    <input class="form-control input-anime"type="text" th:field="*{Amount}" 
                                                    placeholder="Enter Amount" required>
                                                    </div>  
                                                </div> 

                                                <div class="row mt-4">
                                                    <div class="col-sm-5 ">
                                                        <label class="d-label">Receipt:</label>
                                                    </div>
                                                    <div class="col-sm-4">
                                                    <input  type="file" name="ReceiptImg" id="ReceiptImg" accept=".jpg,.png,.jpeg">
                                                    <p>size should be 100 KB</p>
                                                    </div>  
                                                </div> 
                                                
												<button type="submit" class="btn btn-info col-2">Save</button>
                                            </div>
                                   
                                            <div class="col-sm-6">
                                            	<img class="figure-img img-fluid" th:src="@{'/Image Folder/' + ${expense.Receipt}}">
                                          
                                                <input type="hidden" name="oldimage" th:value="${expense.Receipt}" />   
                                            </div>
                                       </div>
                                    </form>
                                    <div class="row mt-4">
                                    	<a th:href="@{/Expense}">Back to List</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>            
            </section>
        </div>
                    <script type="text/javascript">
        		$(document).ready(function () {
            		var table = $('#data-table').DataTable({
                		columnDefs: [{
                    	targets: 0,
                    	orderable: false,
                    	searchable: false,
                    	className: 'selectall-checkbox',
                		}],
                	select: {
                    style: 'multi',
                    selector: 'td:first-child',
                	},
            	});
            	
            	$(function() {
            		var TotalValue1 = ' ';
       				$("#data1").each(function(index,value){
         			currentRow = ($(this).text());
         			TotalValue1 += currentRow
       				});
       				
       				var TotalValue = 0;
       				$("tr #data").each(function(index,value){
         			currentRow1 = parseFloat($(this).text());
         			TotalValue += currentRow1
       				});
				document.getElementById('total').innerHTML = TotalValue1 + '   ' + TotalValue;
				});
            	table.on('select.dt deselect.dt', function (e, dt, type, indexes) {
                	var countSelectedRows = table.rows({ selected: true }).count();
                	var countItems = table.rows().count();

                	if (countItems > 0) {
                    	if (countSelectedRows == countItems) {
                        	$('thead .selectall-checkbox input[type="checkbox"]', this).prop('checked', true);
                    	} else {
                        	$('thead .selectall-checkbox input[type="checkbox"]', this).prop('checked', false);
                    	}
                	}
                	if (e.type === 'select') {
                    	$('.selectall-checkbox input[type="checkbox"]', table.rows({ selected: true }).nodes()).prop('checked', true);
                	} else {
                    	$('.selectall-checkbox input[type="checkbox"]', table.rows({ selected: false }).nodes()).prop('checked', false);
                	}
            	});
          	  // When clicking on "thead .selectall-checkbox", trigger click on checkbox in that cell.
            	table.on('click', 'thead .selectall-checkbox', function () {
                	$('input[type="checkbox"]', this).trigger('click');
            	});
            	// When clicking on the checkbox in "thead .selectall-checkbox"
            	table.on('click', 'thead .selectall-checkbox input[type="checkbox"]', function (e) {
               		if (this.checked) {
                    	table.rows().select();
                	} else {
                    	table.rows().deselect();
                	}
                	e.stopPropagation();
            		});
       			 });

			var dateToday = new Date(); 
				$(document).ready(function () {
            		$( "#fromdate" ).datepicker({
    					dateFormat:'dd-mm-yy',
    					//minDate: dateToday,
    					onClose: function (selected) {
     			 			$("#todate").datepicker("option", "minDate", selected);
   				 			}
  						});
            
            		$("#todate").datepicker({
               			dateFormat: "dd-mm-yy"
            		});
          		 		var table = $('#data-table').DataTable();
          			$("#Category").on('change', function(){
          				$(".data").hide();
          				$("#" + $(this).val()).fadeIn(100);
          			}).change();
				});
	
	 		function myFunction() {
            	document.getElementById("fromlocation").defaultValue = "--";
            	document.getElementById("tolocation").defaultValue = "--";
           		document.getElementById("mode").defaultValue = "--";
            	document.getElementById("location").defaultValue = "--";
        		}

			$("#startDate").datepicker({             
 				dateFormat: "dd-mm-yy",
				onSelect: function(selected) {
    				$("#endDate").datepicker("option","minDate", selected)
        		}
 			}); 
			$("#endDate").datepicker({             
 				dateFormat: "dd-mm-yy",
 				onSelect: function(selected) {
    				$("#startDate").datepicker("option","maxDate", selected)
        		}
	 		}); 
	 		
	 		var uploadField = document.getElementById("ReceiptImg");
				uploadField.onchange = function() {
		    		if(this.files[0].size >= 102400){
		       		alert("File is too big!");
		       		this.value = "";
		    		};
				};
				
			document.getElementById("mySelect").selectedIndex = 0;
			$("input").on("keypress", function(e) {
				if (e.which === 32 && !this.value.length)
					e.preventDefault();
			});
		</script>  	
    </body>        
</html>